<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>APA Hotel Woodbridge IG & FB è‡ªå‹•å›è¦†æ©Ÿå™¨äººæŠ€è¡“æ–‡ä»¶</title>
  <style>
    body {
      font-family: "Noto Sans TC", sans-serif;
      max-width: 900px;
      margin: 20px auto;
      padding: 0 20px;
      line-height: 1.6;
      background: #f9f9f9;
      color: #333;
    }
    h1, h2, h3 {
      color: #004a99;
    }
    pre {
      background: #222;
      color: #eee;
      padding: 10px;
      overflow-x: auto;
      border-radius: 4px;
      font-size: 0.9em;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
    }
    table, th, td {
      border: 1px solid #ccc;
    }
    th, td {
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #004a99;
      color: white;
    }
    a {
      color: #004a99;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    section {
      margin-bottom: 40px;
    }
    footer {
      text-align: center;
      font-size: 0.9em;
      color: #666;
      padding: 20px 0;
    }
  </style>
</head>
<body>
  <h1>APA Hotel Woodbridge Instagram & Facebook è‡ªå‹•å›è¦†æ©Ÿå™¨äººæŠ€è¡“æ–‡ä»¶</h1>

  <section>
    <h2>ğŸ“Œ ç›®çš„</h2>
    <p>æ‰“é€ ä¸€å€‹å¯è‡ªå‹•å›è¦† IG å’Œ Facebook è¨Šæ¯çš„å¤šèªè¨€èŠå¤©æ©Ÿå™¨äººï¼Œæœå‹™ APA Hotel Woodbridge ç²‰çµ²èˆ‡æ½›åœ¨é¡§å®¢ã€‚</p>
  </section>

  <section>
    <h2>âœ… ç³»çµ±åŠŸèƒ½æ¦‚è¿°</h2>
    <ul>
      <li>æ”¯æ´å¹³å°ï¼šInstagram + Facebook Messenger</li>
      <li>èªè¨€æ”¯æ´ï¼šä¸­æ–‡ã€è‹±æ–‡ã€æ—¥æ–‡ï¼ˆè‡ªå‹•åˆ¤æ–·ï¼‰</li>
      <li>åŠŸèƒ½å…§å®¹ï¼š
        <ul>
          <li>å›è¦†è¨‚æˆ¿é€£çµ</li>
          <li>å›è¦†é£¯åº—åœ°å€</li>
          <li>å›è¦†å…¥ä½/é€€æˆ¿æ™‚é–“</li>
          <li>å›è¦†ä¸€èˆ¬æ„Ÿè¬èª</li>
        </ul>
      </li>
    </ul>
  </section>

  <section>
    <h2>ğŸ› ï¸ æ¶æ§‹èˆ‡æŠ€è¡“</h2>
    <ul>
      <li>èªè¨€ï¼šPython</li>
      <li>Web æ¡†æ¶ï¼šFlask</li>
      <li>ä¼ºæœå™¨éƒ¨ç½²ï¼šRenderï¼ˆæ¨è–¦ï¼‰</li>
      <li>ä½¿ç”¨ Facebook Graph API</li>
      <li>ä½¿ç”¨ Webhook æ¥æ”¶è¨Šæ¯äº‹ä»¶</li>
    </ul>
  </section>

  <section>
    <h2>ğŸ“ æª”æ¡ˆçµæ§‹</h2>
    <pre>
project/
â”œâ”€â”€ webhook.py            # ä¸»ç¨‹å¼
â”œâ”€â”€ .env                  # ç’°å¢ƒè®Šæ•¸ï¼ˆä¸æäº¤ GitHubï¼‰
â””â”€â”€ requirements.txt      # å¥—ä»¶æ¸…å–®ï¼ˆä¾› Render ä½¿ç”¨ï¼‰
    </pre>
  </section>

  <section>
    <h2>ğŸ” .env ç’°å¢ƒè®Šæ•¸æ ¼å¼</h2>
    <pre>
VERIFY_TOKEN=your_verify_token_here
    </pre>
  </section>

  <section>
    <h2>ğŸ§  webhook.py ç¨‹å¼åŠŸèƒ½è§£èªª</h2>
    <pre>
from flask import Flask, request
import os
from dotenv import load_dotenv

load_dotenv()

VERIFY_TOKEN = os.getenv("VERIFY_TOKEN")
app = Flask(__name__)

REPLIES = {
    "booking": {
        "en": "Thank you for your interest in APA Hotel Woodbridge. You can make a reservation here: https://www.apahotelwoodbridge.com/",
        "ja": "ã”äºˆç´„ã¯ã“ã¡ã‚‰ï¼šhttps://www.apahotelwoodbridge.com/",
        "zh": "æ„Ÿè¬æ‚¨è¯çµ¡ APA Hotel Woodbridgeã€‚è¨‚æˆ¿è«‹é»é¸ï¼šhttps://www.apahotelwoodbridge.com/"
    },
    "location": {
        "en": "Our address is: 120 Wood Avenue South, Iselin, NJ 08830.",
        "ja": "ä½æ‰€ï¼š120 Wood Avenue South, Iselin, NJ 08830ã€‚",
        "zh": "åœ°å€ï¼š120 Wood Avenue South, Iselin, NJ 08830ã€‚"
    },
    "checkin": {
        "en": "Check-in time: 3:00 PM / Check-out: 11:00 AM.",
        "ja": "ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ï¼š15:00 / ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆï¼š11:00ã€‚",
        "zh": "å…¥ä½æ™‚é–“ï¼šä¸‹åˆ3é»ï¼Œé€€æˆ¿æ™‚é–“ï¼šä¸Šåˆ11é»ã€‚"
    }
}

# åµæ¸¬èªè¨€ï¼ˆç°¡åŒ–æ–¹å¼ï¼‰
def detect_lang(text):
    if any(word in text.lower() for word in ["çš„", "è«‹å•", "æ‚¨å¥½"]):
        return "zh"
    elif any(word in text.lower() for word in ["ã§ã™", "äºˆç´„", "ã“ã‚“ã«ã¡ã¯"]):
        return "ja"
    else:
        return "en"

@app.route("/webhook", methods=["GET", "POST"])
def webhook():
    if request.method == "GET":
        token = request.args.get("hub.verify_token")
        challenge = request.args.get("hub.challenge")
        return challenge if token == VERIFY_TOKEN else "Invalid token"

    if request.method == "POST":
        data = request.get_json()
        print("Incoming:", data)

        for entry in data.get("entry", []):
            for messaging in entry.get("messaging", []):
                sender_id = messaging["sender"]["id"]
                message_text = messaging.get("message", {}).get("text", "")
                lang = detect_lang(message_text)

                if "è¨‚æˆ¿" in message_text or "book" in message_text.lower() or "äºˆç´„" in message_text:
                    reply_text = REPLIES["booking"][lang]
                elif "åœ°å€" in message_text or "address" in message_text.lower():
                    reply_text = REPLIES["location"][lang]
                elif "å…¥ä½" in message_text or "check-in" in message_text.lower():
                    reply_text = REPLIES["checkin"][lang]
                else:
                    reply_text = {
                        "en": "Thank you! We will get back to you shortly.",
                        "zh": "è¬è¬æ‚¨çš„è¨Šæ¯ï¼Œæˆ‘å€‘å°‡ç›¡å¿«å›è¦†ã€‚",
                        "ja": "ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ã™ãã«è¿”ä¿¡ã„ãŸã—ã¾ã™ã€‚"
                    }[lang]

                send_message(sender_id, reply_text)
        return "OK", 200

def send_message(recipient_id, text):
    print(f"[Bot] âœ to {recipient_id}: {text}")
    # Meta Graph API å‘¼å«å€ï¼ˆæ­¤ç¯„ä¾‹åƒ…æ‰“å°ï¼‰

if __name__ == "__main__":
    app.run(debug=True)
    </pre>
  </section>

  <section>
    <h2>ğŸš€ éƒ¨ç½²åˆ° Render</h2>
    <ol>
      <li>å°‡ç¨‹å¼ push è‡³ GitHub Repository</li>
      <li>åˆ° <a href="https://render.com" target="_blank">https://render.com</a> è¨»å†Šå¸³è™Ÿ</li>
      <li>é¸æ“‡ï¼šNew &gt; Web Service</li>
      <li>é¸æ“‡èªè¨€ï¼šPython + é¸æ“‡ GitHub Repo</li>
      <li>è¨­å®šæ¬„ä½ï¼š
        <ul>
          <li>Start commandï¼š<code>gunicorn webhook:app</code></li>
          <li>Secret Fileï¼šæ–°å¢ <code>.env</code> å…§å®¹</li>
        </ul>
      </li>
      <li>é»æ“Š Deploy</li>
      <li>è¤‡è£½ webhook URLï¼Œæ ¼å¼ç‚ºï¼šhttps://xxx.onrender.com/webhook</li>
    </ol>
  </section>

  <section>
    <h2>ğŸ”— IG / FB ä¸²æ¥è¨­å®šæ­¥é©Ÿ</h2>
    <h3>IG å¿…å‚™æ¢ä»¶</h3>
    <ul>
      <li>å°‡ IG å¸³è™Ÿå‡ç´šç‚ºå•†æ¥­å¸³è™Ÿï¼ˆå°ˆæ¥­å¸³è™Ÿï¼‰</li>
      <li>ç¶å®šä¸€å€‹ Facebook ç²‰å°ˆ</li>
    </ul>

    <h3>Meta é–‹ç™¼è€…è¨­å®š</h3>
    <ol>
      <li>å‰å¾€ <a href="https://developers.facebook.com/" target="_blank">https://developers.facebook.com/</a></li>
      <li>å»ºç«‹æ‡‰ç”¨ç¨‹å¼ï¼ˆé¡å‹ï¼šä¼æ¥­ï¼‰</li>
      <li>åŠ å…¥ä»¥ä¸‹ç”¢å“ï¼š
        <ul>
          <li>Instagram Graph API</li>
          <li>Messenger</li>
          <li>Webhooks</li>
        </ul>
      </li>
      <li>Webhook è¨‚é–±ï¼š
        <ul>
          <li>è¨‚é–± <code>messages</code> æ¬Šé™</li>
          <li>å¡«å…¥é©—è­‰ç¶²å€ + verify_tokenï¼ˆèˆ‡ç¨‹å¼ä¸€è‡´ï¼‰</li>
        </ul>
      </li>
      <li>è¨­å®šæ¬Šæ–ï¼ˆä½¿ç”¨ Graph API Explorer å–å¾— Page Access Tokenï¼‰</li>
    </ol>
  </section>

  <section>
    <h2>ğŸ“š å¸¸è¦‹è¨Šæ¯èˆ‡å›è¦†ç¯„æœ¬</h2>
    <table>
      <thead>
        <tr>
          <th>å•é¡Œé—œéµå­—</th>
          <th>ä¸­æ–‡å›è¦†</th>
          <th>è‹±æ–‡å›è¦†</th>
          <th>æ—¥æ–‡å›è¦†</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>è¨‚æˆ¿</td>
          <td>æ„Ÿè¬æ‚¨è¯çµ¡ APA Hotel Woodbridgeã€‚è¨‚æˆ¿è«‹é»é¸ï¼šhttps://www.apahotelwoodbridge.com/</td>
          <td>Thank you for your interest in APA Hotel Woodbridge. You can make a reservation here: https://www.apahotelwoodbridge.com/</td>
          <td>ã”äºˆç´„ã¯ã“ã¡ã‚‰ï¼šhttps://www.apahotelwoodbridge.com/</td>
        </tr>
        <tr>
          <td>åœ°å€</td>
          <td>åœ°å€ï¼š120 Wood Avenue South, Iselin, NJ 08830ã€‚</td>
          <td>Our address is: 120 Wood Avenue South, Iselin, NJ 08830.</td>
          <td>ä½æ‰€ï¼š120 Wood Avenue South, Iselin, NJ 08830ã€‚</td>
        </tr>
        <tr>
          <td>å…¥ä½</td>
          <td>å…¥ä½æ™‚é–“ï¼šä¸‹åˆ3é»ï¼Œé€€æˆ¿æ™‚é–“ï¼šä¸Šåˆ11é»ã€‚</td>
          <td>Check-in time: 3:00 PM / Check-out: 11:00 AM.</td>
          <td>ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ï¼š15:00 / ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆï¼š11:00ã€‚</td>
        </tr>
        <tr>
          <td>è¬è¬</td>
          <td>è¬è¬æ‚¨çš„è¨Šæ¯ï¼Œæˆ‘å€‘å°‡ç›¡å¿«å›è¦†ã€‚</td>
          <td>Thank you! We will get back to you shortly.</td>
          <td>ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ã™ãã«è¿”ä¿¡ã„ãŸã—ã¾ã™ã€‚</td>
        </tr>
      </tbody>
    </table>
  </section>

<section>
  <h2>ğŸ”„ ç›®å‰é€²åº¦</h2>
  <ul>
    <li>å®Œæˆ IG å’Œ Facebook Messenger çš„åŸºæœ¬è‡ªå‹•å›è¦†åŠŸèƒ½é–‹ç™¼ã€‚</li>
    <li>å®Œæˆå¤šèªè¨€ï¼ˆä¸­ã€è‹±ã€æ—¥ï¼‰è¨Šæ¯åˆ¤æ–·èˆ‡å›è¦†ã€‚</li>
    <li>åŸºç¤é—œéµå­—å›è¦†é‚è¼¯å·²å®Œæˆï¼ŒåŒ…å«è¨‚æˆ¿ã€åœ°å€ã€å…¥ä½æ™‚é–“èˆ‡æ„Ÿè¬èªã€‚</li>
  </ul>
</section>

<section>
  <h2>ğŸ› ï¸ æœªå®Œæˆé …ç›® / ä¸‹ä¸€æ­¥å»ºè­°</h2>
  <ul>
    <li> Render éƒ¨ç½²æ¸¬è©¦ï¼ŒWebhook å¯æ­£å¸¸æ¥æ”¶è¨Šæ¯ã€‚</li>
    <li>å¢åŠ æ›´å¤šè‡ªç„¶èªè¨€è™•ç†èƒ½åŠ›ï¼Œä½¿èªè¨€åˆ¤æ–·æ›´æº–ç¢ºã€‚</li>
    <li>å®Œå–„ Facebook Graph API çš„è¨Šæ¯ç™¼é€åŠŸèƒ½ï¼Œå¯¦éš›å›è¦†ä½¿ç”¨è€…ã€‚</li>
    <li>åŠ å…¥ä½¿ç”¨è€…è¨Šæ¯ç´€éŒ„åŠŸèƒ½ï¼Œæ–¹ä¾¿å¾ŒçºŒåˆ†æèˆ‡å„ªåŒ–ã€‚</li>
    <li>æ“´å……æ›´å¤šå¸¸è¦‹å•é¡Œçš„é—œéµå­—èˆ‡å›è¦†å…§å®¹ã€‚</li>
    <li>è¨­è¨ˆèŠå¤©æ©Ÿå™¨äººå¤šè¼ªå°è©±æµç¨‹ï¼Œæé«˜äº’å‹•æ€§ã€‚</li>
  </ul>
</section>


  <footer>
    <p>Â© 2025 APA Hotel Woodbridge è‡ªå‹•å›è¦†æ©Ÿå™¨äººå°ˆæ¡ˆ</p>
  </footer>
</body>
</html>
